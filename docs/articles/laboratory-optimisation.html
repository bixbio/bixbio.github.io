<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pieter Ross">
<meta name="dcterms.date" content="2024-10-28">
<meta name="description" content="A retrospective look at the application of tried-and-tested process engineering techniques in a laboratory setting.">

<title>Laboratory Process Optimisation using LEAN Thinking – bixbio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/icon-small.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<meta property="og:title" content="Laboratory Process Optimisation using LEAN Thinking – bixbio">
<meta property="og:description" content="A retrospective look at the application of tried-and-tested process engineering techniques in a laboratory setting.">
<meta property="og:image" content="images/brand-medium.png">
<meta property="og:site_name" content="bixbio">
<meta name="twitter:title" content="Laboratory Process Optimisation using LEAN Thinking – bixbio">
<meta name="twitter:description" content="A retrospective look at the application of tried-and-tested process engineering techniques in a laboratory setting.">
<meta name="twitter:image" content="images/brand-medium.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/icon-small.png" alt="bixbio" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-articles" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Articles</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-articles">    
        <li>
    <a class="dropdown-item" href="../articles/haplotype-diversity.html">
 <span class="dropdown-text">Genetic Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/bixbio-dataset.html">
 <span class="dropdown-text">Bixbio Dataset</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/laboratory-optimisation.html">
 <span class="dropdown-text">Laboratory Optimisation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles.html">
 <span class="dropdown-text">All</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#the-big-picture" id="toc-the-big-picture" class="nav-link active" data-scroll-target="#the-big-picture">The big picture</a></li>
  <li><a href="#introducing-the-landscape" id="toc-introducing-the-landscape" class="nav-link" data-scroll-target="#introducing-the-landscape">Introducing the landscape</a></li>
  <li><a href="#navigating-the-challenges" id="toc-navigating-the-challenges" class="nav-link" data-scroll-target="#navigating-the-challenges">Navigating the challenges</a></li>
  <li><a href="#the-challenge-we-faced" id="toc-the-challenge-we-faced" class="nav-link" data-scroll-target="#the-challenge-we-faced">The challenge we faced</a></li>
  <li><a href="#our-solution" id="toc-our-solution" class="nav-link" data-scroll-target="#our-solution">Our solution</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Laboratory Process Optimisation using LEAN Thinking</h1>
</div>

<div>
  <div class="description">
    A retrospective look at the application of tried-and-tested process engineering techniques in a laboratory setting.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pieter Ross </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="the-big-picture" class="level2">
<h2 data-anchor-id="the-big-picture">The big picture</h2>
<p>Producing high-quality, valuable data requires a process that is thorough, consistent, and clearly understood by everyone involved. This need is especially important when handling genomic data, where the stakes are high – both financially, given the expense of generating this data, and scientifically, due to the precision required in each lab procedure. With genetic information being among the most sensitive data one can collect, it’s essential to prioritise not only the quality and accuracy of the results but also the rigour of the protocols followed by all team members involved. To ensure that our findings are reliable, accurate, and efficiently produced, we applied LEAN thinking to transform the workflow.</p>
</section>
<section id="introducing-the-landscape" class="level2">
<h2 data-anchor-id="introducing-the-landscape">Introducing the landscape</h2>
<p>For those unfamiliar with the workings of a research lab, it’s a more complex environment than it might first appear. Research laboratories are structured to support a diverse range of operations, often leading to setups that can be challenging from an efficiency standpoint – far from the streamlined structure of a factory or high-throughput facility. In this setting, precision equipment is tailored to specific tasks: pipettes, centrifuges, shakers, sequencers, and fumehoods are all essential tools, each with a distinct role in the workflow. Add to this a range of consumables like pipette tips, PCR plates, microseals, and filters, alongside carefully stored reagents that need precise handling and refrigeration, and you have an intricate web of resources to manage.</p>
<p>Successfully analysing the human genome demands careful orchestration of these resources, starting with extracting human DNA from a sample – usually blood – and preparing it for sequencing, a process used to determine the sequence of nucleotides in DNA. Each stage involves multiple steps, both chemical and mechanical, and requires transferring samples across various stations in the lab without introducing contaminants or errors- all while working at the microliter scale. The aim is to maintain consistency and minimise variability, but this is no simple task.</p>
</section>
<section id="navigating-the-challenges" class="level2">
<h2 data-anchor-id="navigating-the-challenges">Navigating the challenges</h2>
<p>One of the most significant challenges in lab work is maintaining control over these components to avoid any missteps. Even minor errors can lead to skewed results and unreliable conclusions. Given the high costs associated with genome sequencing, reducing errors is imperative, as is detecting them immediately should they occur. Laboratory protocols often span several hours or even days, adding a layer of complexity as labs work to meet time-sensitive deadlines in a setting that doesn’t always prioritise efficiency.</p>
<p>Balancing all these demands – precise handling, error avoidance, and timely delivery – can strain lab personnel and introduce fatigue, a common precursor to mistakes. By implementing LEAN methodologies, we’ve transformed these complexities into structured, repeatable processes that consistently produce high-quality data without overburdening lab technicians. LEAN has been instrumental in shaping our operations, fostering an environment where reliability, consistency, and quality are the norms, all while reducing the risk of technician burnout.</p>
</section>
<section id="the-challenge-we-faced" class="level2">
<h2 data-anchor-id="the-challenge-we-faced">The challenge we faced</h2>
<p>Our team encountered a unique set of challenges: we needed to process a large volume of irreplaceable samples through multiple lab protocols, from DNA extraction to sequencing, with a small team where only one member had lab experience. Compounding this were the high costs associated with sequencing and the fact that the samples were shipped internationally, which left little room for error or reruns.</p>
<p>Adding to the complexity, our laboratory setup was research-oriented rather than optimised for high throughput, meaning we couldn’t simply adopt manufacturing processes. Instead, each workflow we developed had to be closely aligned with scientific requirements, following strict quality metrics in each phase of the process. These protocols were time-intensive and involved hours-long steps, further limited by the availability of sequencers. Given these constraints, our process needed to be resilient, repeatable, and scientifically robust.</p>
</section>
<section id="our-solution" class="level2">
<h2 data-anchor-id="our-solution">Our solution</h2>
<p>Through LEAN principles, we transformed our research-driven workflow into an operation resembling a high-throughput facility. This shift allowed us to process batches of samples – from DNA extraction through sequencing – at a much faster rate, increased process flow, reduced our error rate to nearly zero, and established procedures that were repeatable and easy to follow.</p>
<p>Applying LEAN methodologies, we adopted practices like continuous improvement, visual management, work levelling (Heijunka), Just-in-Time, and strategies to reduce waste (Muda), overload (Muri), and inconsistency (Mura). Each concept had a specific role in streamlining our processes and rethinking problem-solving within our lab. These methods trace back to the Toyota Production System, where continuous improvements led to better flow in production and a more varied product line than what Ford had developed with flow production.</p>
<p>LEAN allowed us to minimise mistakes, eliminate waste, and establish a reliable, repeatable process. Through continuous improvement (Kaizen), we identified process weaknesses and systematically refined them, enhancing both efficiency and quality.</p>
<section id="gemba" class="level3">
<h3 data-anchor-id="gemba">Gemba<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h3>
<p>Before any improvements, we immersed ourselves in the lab’s prescribed processes, observing and experiencing each protocol in detail. This hands-on approach, known in LEAN as “walking the Gemba”, involved acknowledging and learning from inevitable mistakes to understand our protocols thoroughly. Only by recognising these details were we able to make informed adjustments toward efficiency.</p>
</section>
<section id="implementing-5s" class="level3">
<h3 data-anchor-id="implementing-5s">Implementing 5S</h3>
<p>After familiarising ourselves with the process, we implemented improvement strategies to enhance quality and minimise errors. Given that we work with highly sensitive genetic data, accuracy is critical, and errors must be caught as early as possible. We used visual management and the 5S method – Sort, Set in Order, Shine, Standardise, and Sustain – to bring structure to the workflow and eliminate distractions.</p>
<p>We organised lab equipment and supplies systematically, ensuring that only essential items for each protocol were present. For instance, we designated specific zones on the workbench with taped outlines for necessary tools, ensuring that items like the magnet block were always in the same spot. This setup made it simple to check if any equipment was missing, saved time during protocol setup, and visually decluttered the workspace, reducing distractions and potential errors.</p>
<p>Through these initiatives, we created a structured, dependable environment that not only improved workflow but also enhanced the overall quality and consistency of our results.</p>
</section>
<section id="visual-management" class="level3">
<h3 data-anchor-id="visual-management">Visual management</h3>
<p>In a complex lab environment, where technicians handle minuscule volumes down to microliters, keeping track of each step is challenging, especially with the potential for distraction. Technicians often use memorisation tricks to track positions on a 96-well PCR plate, but even a brief lapse can disrupt accuracy. We started by understanding the general process that is followed in each iteration of handling a sample (An illustration of the flow is below). We then, to counter any disruption, created a reliable orientation method to ensure consistency in handling the plate.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A(((Start))) --&gt; B([Remove pipette tip &lt;br&gt; from position A1]) 
  B --&gt; C([Collect the &lt;br&gt; required reagent])
  C --&gt; D([Insert reagent&lt;br&gt; into position A1])
  D --&gt; E([Discard the&lt;br&gt; pipette tip])
  E --&gt; F(((End)))

  style A fill:#32CD32,stroke:#000000,stroke-width:2px
  style F fill:#FF0000,stroke:#000000,stroke-width:2px
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>We aligned the orientation of the pipette tip box with the reagents and the PCR plate itself, so the bottom-left corner of each (say, position A1) always corresponded across the materials. This meant that if a pipette tip was missing from a specific position, it indicated that the corresponding well on the PCR plate had already received its reagent. For example, if a technician reached position C5 in the pipette box, they would know to input reagent into position C5 on the PCR plate.</p>
<p>To simplify this even further, we designed a template for the transparent PCR plate with a visible “crosshair” indicator, marking the correct well for each step. This template served as a basic poka-yoke (error-proofing) tool, providing a visual cue to reduce mistakes and a third layer of assurance for accurate pipetting.</p>
</section>
<section id="enhancing-flow" class="level3">
<h3 data-anchor-id="enhancing-flow">Enhancing flow</h3>
<p>The concept of continuous flow, borrowed from manufacturing, proved invaluable in refining our processes. Any disruption in flow indicated an opportunity for improvement. With this approach, we focused on planning each step carefully to maintain an uninterrupted sequence from start to finish.</p>
<p>A major gain in efficiency came from pre-marking and organising consumables before starting each protocol. Understanding the transformations that samples undergo throughout a protocol enables us to anticipate needs and keep materials ready, minimising delays and reducing the chance of error.</p>
<p>We also noticed excessive hand movement as a source of technician fatigue and errors. To address this, we mapped out an ideal sequence of actions – selecting the pipette, attaching the tip, gathering the reagent, inputting it into the sample, and discarding the tip – and arranged the workspace within the fumehood accordingly (An diagram of the workflow is seen below). Pipettes, tips, reagents, and waste bins were all placed to facilitate a smooth, left-to-right workflow. This setup was especially beneficial in our mixed-use lab, where benches were cleared daily, making it essential to have an arrangement that could be reestablished quickly.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
A(((Start))) --&gt; B([Choose the &lt;br&gt;correct pipette])
B --&gt; C([Pick up the &lt;br&gt; pipette tip])
C --&gt; D([Collect &lt;br&gt; the reagent])
D --&gt; E([Insert reagent &lt;br&gt; into the sample])
E --&gt; F([Discard &lt;br&gt; pipette tip])
F --&gt; G(((End)))

  style A fill:#32CD32,stroke:#000000,stroke-width:2px
  style G fill:#FF0000,stroke:#000000,stroke-width:2px
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>We extended this flow approach beyond the fumehood, arranging the entire lab space to maintain a logical sequence, with minimal walking needed between workstations. Equipment was organised to keep necessary tools within one or two steps, reducing the risk of errors from sample handling. This layout borrowed from the concept of “work cells” in manufacturing, creating a cohesive workspace that enhanced both efficiency and accuracy across protocols.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 data-anchor-id="conclusion">Conclusion</h2>
<p>Applying LEAN thinking in our lab provided a significant edge in data quality and efficiency. By adopting these methods, we not only enhanced data accuracy and reduced error rates but also minimised hands-on protocol time and increased overall throughput. LEAN thinking allowed us to take incremental, practical steps toward continuous improvement, identifying inefficiencies and implementing effective solutions that boosted productivity across the board.</p>
<p>The outcome was a streamlined, repeatable process with well-documented protocols, which in turn reduced technician fatigue and contributed to a successful project outcome. This case illustrates how LEAN principles, though traditionally associated with manufacturing, can be transformative in a lab environment as well.</p>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Gemba is the Japanese term for “actual place,” often used for the shop floor or any place where value-creating work actually occurs.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 Bixbio Ltd</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>